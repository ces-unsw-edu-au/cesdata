# MODIS/Terra Snow Cover 8-Day L3 Global 0.05Deg CMG, Version 6

https://nsidc.org/data/mod10c2/versions/6
Data Set ID: MOD10C2

> This data set is generated from Normalized Difference Snow Index (NDSI) snow cover. Snow covered land typically has a very high reflectance in visible bands and very low reflectance in the shortwave infrared; the NDSI reveals the magnitude of this difference. MOD10A2 eight-day maximum snow extent observations at 500 m resolution are mapped into 0.05 degrees (approx. 5 km) CMG cells, binned by observation type (e.g. snow, snow-free land, cloud, etc.), and tallied. Snow and cloud cover percentages are generated by computing the ratio of snow or cloud observation counts to the total number of land observations mapped into the CMG cell.


## Citation
> Hall, D. K. and G. A. Riggs. 2016. MODIS/Terra Snow Cover 8-Day L3 Global 0.05Deg CMG, Version 6. [Indicate subset used]. Boulder, Colorado USA. NASA National Snow and Ice Data Center Distributed Active Archive Center. doi: https://doi.org/10.5067/MODIS/MOD10C2.006. [Date Accessed].


Download script (python) available, add login details for earthdata in ~/.netrc as follow:
machine urs.earthdata.nasa.gov login ***** password *****

```sh
source ~/proyectos/UNSW/cesdata/env/project-env.sh


mkdir -p $GISDATA/cryosphere/global/Modis-MOD10C2/
cd $GISDATA/cryosphere/global/Modis-MOD10C2/
## scp nsidc-download_MOD10C2.006_2021-03-29.py $zID@kdm.restech.unsw.edu.au:/srv/scratch/cesdata/gisdata/cryosphere/global/Modis-MOD10C2/

python nsidc-download_MOD10C2.006_2021-03-29.py
```

This downloads 1932 files

# MODIS/Terra Snow Cover 8-Day L3 Global 500m SIN Grid, Version 6
https://nsidc.org/data/mod10a2/versions/6
Data Set ID: MOD10A2

We repeat the same procedure, this will download 590880 files!
```sh
source ~/proyectos/UNSW/cesdata/env/project-env.sh


mkdir -p $GISDATA/cryosphere/global/Modis-MOD10A2/
cd $GISDATA/cryosphere/global/Modis-MOD10A2/
## scp nsidc-download_MOD10A2.006_2021-03-30.py $zID@kdm.restech.unsw.edu.au:/srv/scratch/cesdata/gisdata/cryosphere/global/Modis-MOD10A2/

## manual edit to add bounding box, start and end dates, filename match, etc...
less nsidc-download_MOD10A2.006_2021-03-30.py

for YEAR in $(seq 2010 2020)
do
  cd $GISDATA/cryosphere/global/Modis-MOD10A2/$YEAR
  for k in $(ls | cut -d. -f2 | uniq | grep ^A)
  do
    echo $k
    mkdir -p $k
    mv *${k}*.hdf $k
    mv *${k}*.xml $k
  done
done

```


Maximum_Snow_Extent:
> The maximum snow extent during the eight-day period plus other values. Cells with snow on any day during the period are mapped as snow. Clouds are only reported if all eight days were obscured by clouds. Cells with no snow are filled with the observation that occurred most often. Possible values are: 0: missing data 1: no decision 11: night 25: no snow 37: lake 39: ocean 50: cloud 100: lake ice 200: snow 254: detector saturated 255: fill

Eight_Day_Snow_Cover:
> Snow chronology bit flags. Each day has its own bit that is set to: on (1), if snow was observed on that day; or off (0), for no snow, cloud, or missing data. Days/bits are ordered across the byte from right to left: bit 7 bit 6 bit 5 bit 4 bit 3 bit 2 bit 1 bit 0 day 8 day 7 day 6 day 5 day 4 day 3 day 2 day 1  To retrieve the bit flags, convert the integer stored in the SDS into its binary representation. For example, if a cell contains the value 229, expressing that number in binary yields: 11100101. Read from right to left, the flags indicate that snow was observed in the cell on days 1, 3, 6, 7, and 8 of the compositing period, while no snow was observed on days 2, 4, and 5.


Bounding box example
137,-5,138,-4

Bounding box tropical glaciers
-100,-25,138,20

```sh
source ~/proyectos/UNSW/cesdata/env/project-env.sh


cd $WORKDIR
qsub -l select=1:ncpus=2:mem=16gb,walltime=12:00:00 -J 2019-2021 $SCRIPTDIR/inc/pbs/download-cryosphere-modis-products.pbs
qsub -l select=1:ncpus=2:mem=16gb,walltime=12:00:00 -J 2000-2018 $SCRIPTDIR/inc/pbs/download-cryosphere-modis-products.pbs

```

## Virtual raster datasets

```sh
ssh $zID@katana.restech.unsw.edu.au
qsub -I -l select=1:ncpus=1:mem=120gb,walltime=12:00:00

module add python/3.8.3 perl/5.28.0 gdal/3.2.1 geos/3.8.1

source ~/proyectos/UNSW/cesdata/env/project-env.sh

cd $GISDATA/cryosphere/global/Modis-MOD10A2/
export VAR=MOD10A2
export VRS=006

# gdalinfo 2019.01.01/MOD11A2.A2019001.h01v08.006.2019010204437.hdf

# gdalinfo HDF4_EOS:EOS_GRID:"2019.01.01/MCD12Q1.A2019001.h01v08.006.2020212125329.hdf":MODIS_Grid_8Day_1km_LST:LST_Day_1km

for YEAR in $(seq 2000 2010)
do
   mkdir -p $GISDATA/cryosphere/global/Modis-${VAR}/index/${YEAR}
   cd $GISDATA/cryosphere/global/Modis-${VAR}/index/${YEAR}
   for FECHA in $(grep ^A$YEAR $GISDATA/cryosphere/global/Modis-${VAR}/links)
   do
      echo $FECHA
      [ -e index_${VAR}_${VRS}_${FECHA}_Maximum_Snow_Extent.vrt ] && echo "listo" || gdalbuildvrt index_${VAR}_${VRS}_${FECHA}_Maximum_Snow_Extent.vrt -sd 1 $GISDATA/cryosphere/global/Modis-${VAR}/$FECHA/*hdf
      [ -e index_${VAR}_${VRS}_${FECHA}_Eight_Day_Snow_Cover.vrt ] && echo "listo" || gdalbuildvrt index_${VAR}_${VRS}_${FECHA}_Eight_Day_Snow_Cover.vrt -sd 2 $GISDATA/cryosphere/global/Modis-${VAR}/$FECHA/*hdf

   done

done

export VAR=MOD11A2
export VRS=006

cd $GISDATA/land-surface-temperature/global/Modis-${VAR}.${VRS}/index/


```


## example for Myanmar
```sh
mkdir -p ~/tmp/alpine/Myanmar
cd ~/tmp/alpine/Myanmar

for k in $(ls /opt/gisdata/sensores/Modis/MOD10C2/*hdf)
do
   for BAND in Eight_Day_CMG_Snow_Cover Snow_Spatial_QA Eight_Day_CMG_Clear_Index
   do
      export j=$(basename $k | sed -e s/.hdf/.tif/ -e s/MOD10C2/${BAND}/)

      gdalwarp -of Gtiff -co COMPRESS=LZW -co TILED=YES -ot Byte -te 92 25 99 29  -t_srs EPSG:4326 HDF4_EOS:EOS_GRID:"${k}":MOD_CMG_Snow_5km:${BAND} ${j}
      done
done

gdalinfo $k
export BAND=Eight_Day_CMG_Snow_Cover
export WEEK=A2000049

gdalwarp -of Gtiff -co COMPRESS=LZW -co TILED=YES -ot Byte -te -180.0000000 -90.0000000 180.0000000 90.0000000  -t_srs EPSG:4326 HDF4_EOS:EOS_GRID:"MOD10C2.${WEEK}.006.2016064132927.hdf":MOD_CMG_Snow_5km:${BAND} MOD10C2-${WEEK}-${BAND}.tif

cd $WORKDIR
grass -c $GISDATA/sensores/Modis/MOD10C2/MOD10C2-${WEEK}-${BAND}.tif $GISDB/MODIS_snow
r.in.gdal input=$GISDATA/sensores/Modis/MOD10C2/MOD10C2-${WEEK}-${BAND}.tif output=MOD10C2_${WEEK}_${BAND}

```

In google earth engine
https://developers.google.com/earth-engine/datasets/catalog/MODIS_006_MOD10A1

Hall, D. K., V. V. Salomonson, and G. A. Riggs. 2016. MODIS/Terra Snow Cover Daily L3 Global 500m Grid. Version 6. Boulder, Colorado USA: NASA National Snow and Ice Data Center Distributed Active Archive Center.
https://doi.org/10.5067/MODIS/MOD10A1.006

Global EASE-Grid 8-day Blended SSM/I and MODIS Snow Cover, Version 1
https://cmr.earthdata.nasa.gov/search/concepts/C1386250333-NSIDCV0.html

Read https://daacdata.apps.nsidc.org/pub/DATASETS/nsidc0321_blended_ssmi_modis/readme.txt
%ftp sidads.colorado.edu
     (login as anonymous, and use your e-mail address as password)
ftp>cd /pub/DATASETS/nsidc0321_blended_ssmi_modis/
ftp>get north.tar
